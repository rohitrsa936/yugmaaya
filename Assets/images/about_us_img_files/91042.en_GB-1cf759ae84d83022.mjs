(self.modernJsonp=self.modernJsonp||[]).push([["91042"],{935850(e,t,a){var s;a.r(t),a.d(t,{default:()=>i});let o={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PinSaveRequest_pin",selections:[{alias:"images_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s=[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"orig")'},{alias:"images_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promotedIsRemovable",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackingParams",storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageBase64",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mediaUploadId",storageKey:null}]}],type:"Pin",abstractKey:null};o.hash="64132b88edd48497e63c9ad85ae5ab66";let i=o},583215(e,t,a){a.r(t),a.d(t,{default:()=>o});let s={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PinSaveRequest_shuffle_asset",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],type:"ShuffleAsset",abstractKey:null};s.hash="58c24e25a76e7a1c4533f3b07f490517";let o=s},363508(e,t,a){a.d(t,{A:()=>C});var s=a(97407),o=a(296540),i=a(328138),l=a(498653),n=a(443715),r=a(403532),d=a(305167),c=a(474848);function u({anchorRef:e,board:t,onBoardSelect:a,onDismiss:u,popoverId:p,urlPinInfo:_}){(0,o.useEffect)(()=>{(0,s.A)("BoardPicker","/app/common/react/components/Lens/Save/BoardPicker.tsx")},[]);let[h,m]=(0,o.useState)(!1),[v,S]=(0,o.useState)(""),b=(0,o.useCallback)(e=>{let{id:t,name:s,url:o}=e;a({id:t,name:s,url:o}),u()},[a,u]),f=(0,o.useCallback)(e=>{if(!e.boardId)return;let{boardId:t,title:s,url:o}=e;a({id:t,name:s??void 0,url:o??void 0}),u()},[a,u]),g=(0,o.useCallback)(e=>{S(e?.title??""),m(!0)},[]),P=(0,o.useCallback)(()=>{m(!1),u()},[u]);return(0,c.jsx)(i.Wd,{zIndex:new i.K5([l.B4]),children:h?(0,c.jsx)(r.A,{boardCreateSource:"board_picker",images:[{url:_.imageUrl,name:""}],initialValues:{boardName:v},onBoardCreate:b,onClose:P}):(0,c.jsx)(i.AM,{anchor:e.current,id:p,idealDirection:"down",onDismiss:u,positionRelativeToAnchor:!1,size:"xl",children:(0,c.jsx)(n.A,{children:(0,c.jsx)(d.cC,{displayShortlistMostRecentBoard:!0,onBoardCreate:g,onItemChosen:f,selectedItem:t,showCreateBoardButton:!0,showFlyoutSaveButton:!1,showSaveToProfile:!0})})})})}var p=a(526607),_=a(901856),h=a(55268),m=a(643357),v=a(211974),S=a(443400),b=a(671468),f=a(871211),g=a(62923);function P({board:e,onSaveComplete:t,urlPinInfo:a}){return(0,o.useEffect)(()=>{(0,s.A)("SaveHandler","/app/common/react/components/Lens/Save/SaveHandler.tsx")},[]),(0,c.jsx)(g.a,{action:"create",description:"",method:"lens",pinKey:null,setCompletionPromise:t,urlPinInfo:a,children:({handleSaveToBoard:t})=>(0,c.jsx)(y,{board:e,handleSaveToBoard:t})})}function y({board:e,handleSaveToBoard:t}){return(0,f.A)(()=>{t({...e,type:"board"})}),null}var A=a(340577);function C({imageUrl:e,saveButtonOnly:t=!1}){(0,o.useEffect)(()=>{(0,s.A)("LensBetterSave","/app/common/react/components/Lens/Save/LensBetterSave.tsx")},[]);let a=(0,o.useId)(),l=(0,o.useRef)(null),n=(0,o.useRef)(null),r=t?l:n,[d,f]=(0,o.useState)(!1),{isSaved:g,board:y,urlPinInfo:C,saveImageToBoard:w,handleUnsave:x,renderPendingSave:I}=function({imageUrl:e}){let t={description:"",imageUrl:e,link:""},a=function(){let e=(0,b.d4)(e=>e.mostRecentBoard);if(e)return{id:e.id,name:e.name,url:e.url}}(),{isSaved:s,savedBoard:i,handleBoardSaveComplete:l,handleUnsave:n,setOptimisticSave:r}=function({imageUrl:e}){let t=(0,m.A)(),a=(0,v.CG)(),{getSavedImageState:s,setSavedImageState:i,clearSavedImageState:l}=(0,p.S)(),n=s(e),[r,d]=(0,o.useState)(!!n),[u,b]=(0,o.useState)(n?.pinId??null),[f,g]=(0,o.useState)(n?.board),P=(0,o.useCallback)(async(s,o)=>{await (0,_.A)({url:"/v3/pins/{pin}/",urlParams:{pin:s},method:"DELETE"}),d(!1),b(null),g(void 0),l(e);let i=o?t.bt("Removed from your board.", "Removed from your board!", "LensBetterSave.RemovedFromBoard", undefined, true):t.bt("Pin removed.", "Pin removed!", "LensBetterSave.PinRemoved", undefined, true);a.showToast(({hideToast:e})=>(0,c.jsx)(h.A,{dataTestId:"lens-better-save-removed-toast",onHide:e,text:i}))},[l,t,e,a]),y=(0,o.useCallback)(async()=>{u&&await P(u,!!f?.id)},[u,f?.id,P]),A=(0,o.useCallback)(e=>{d(!0),g(e)},[]);return{isSaved:r,savedBoard:f,handleBoardSaveComplete:(0,o.useCallback)(async t=>{let{id:s,board:o}=await t.promise,{id:l,name:n,url:r}=o,u={id:l,name:n,url:r};d(!0),b(s),g(u),i(e,{pinId:s,board:u}),a.showToast(({hideToast:t})=>(0,c.jsx)(S.A,{boardName:n,boardUrl:r,onHide:t,onUndo:async()=>{t(),await P(s,!!l)},pinImageUrl:e}))},[e,i,a,P]),handleUnsave:y,setOptimisticSave:A}}({imageUrl:e}),{setPendingBoard:d,renderPendingSave:u}=function({urlPinInfo:e,onBoardSaveComplete:t}){let[a,s]=(0,o.useState)(null),i=(0,o.useCallback)(()=>a?(0,c.jsx)(P,{board:a,onSaveComplete:async e=>{await t(e),s(null)},urlPinInfo:e}):null,[a,t,e]);return{setPendingBoard:s,renderPendingSave:i}}({urlPinInfo:t,onBoardSaveComplete:l});return{isSaved:s,board:i??a,urlPinInfo:t,saveImageToBoard:(0,o.useCallback)(e=>{r(e),d(e)},[r,d]),handleUnsave:n,renderPendingSave:u}}({imageUrl:e}),k=(0,o.useCallback)(e=>{(e.stopPropagation(),t&&g)?x():f(e=>!e)},[t,g,x]),E=(0,o.useCallback)(async e=>{(e.stopPropagation(),g)?x():!y?.id||t?f(!0):w(y)},[y,t,g,x,w]);return(0,c.jsxs)(i.az,{ref:l,"data-test-id":"lens-better-save",width:"100%",children:[(0,c.jsx)(A.A,{accessibilityControls:a,accessibilityExpanded:d,accessibilityHaspopup:!0,dropdownRef:n,hideDropdown:t,isSaved:g,onBoardDropdownClick:k,onSaveClick:E,promotedIsLeadAd:!1,selectedTitle:y?.name,showBoardFlyout:d,unselectedText:"Select",view:"pin"}),d&&(0,c.jsx)(u,{anchorRef:r,board:y,onBoardSelect:w,onDismiss:()=>f(!1),popoverId:a,urlPinInfo:C}),I()]})}},498653(e,t,a){a.d(t,{B4:()=>_,CR:()=>c,Dj:()=>f,Et:()=>S,Gj:()=>r,J8:()=>p,SY:()=>d,UQ:()=>g,WK:()=>v,YU:()=>l,cr:()=>P,g0:()=>m,jr:()=>y,nb:()=>h,qm:()=>u,rm:()=>n,tF:()=>b});var s=a(328138),o=a(643357),i=a(502470);let l="/v3/visual_search/lens/history/",n=119,r=4054,d=15075,c=119,u=150,p=540,_=new s.K5([i.Bf]),h="CAMERA_GALLERY",m="image/jpeg",v=".jpg",S=.8,b="unsupportedFormat",f=1200,g="/v3/visual_search/lens/upload/",P="IMAGE_URL",y=()=>(0,o.A)()._("Something went wrong. Please try again","lens.error.uploadFailed","Error message when file upload fails unexpectedly")},870637(e,t,a){a.d(t,{A:()=>d,r:()=>r});var s=a(296540),o=a(275552),i=a(869344),l=a(556596),n=a(534955);function r(e,t){let{setViewContextData:a}=(0,i.x)(),{requestIdentifier:r}=(0,n._8)(),d=(0,o.A)(),{viewData:c}=(0,i.WQ)();(0,s.useEffect)(()=>{e&&(a({viewType:e.view_type??1,viewParameter:e.view_parameter,viewData:e.view_data?(0,l.A)(c,e.view_data):c,component:e.component,element:e.element,objectIdStr:e.object_id_str,auxData:e.aux_data,clientTrackingParams:e.clientTrackingParams}),d({...e,event_type:13,request_identifier:r}))},[t])}function d(e){let{children:t,log:a}=e;return r(a),t||null}},998345(e,t,a){a.d(t,{Ii:()=>_,LB:()=>l,MZ:()=>c,NZ:()=>p,O5:()=>A,OY:()=>n,Ow:()=>r,QD:()=>h,Rv:()=>f,UP:()=>u,WH:()=>i,Wi:()=>m,cP:()=>d,iA:()=>P,j:()=>S,jy:()=>g,lo:()=>b,mQ:()=>C,mg:()=>o,rt:()=>s,sT:()=>v,tC:()=>y});let s=236,o=270,i=157.33333333333334,l=175,n=24,r=4,d=8,c=2,u=8,p=2,_=14,h=16,m=16,v=24,S=16,b=-1,f=2,g=(e=!1,t=!1)=>e?t?m:12:v,P=({defaultItemWidth:e,contentVisibleItemCount:t,gap:a,moduleWidth:s})=>t||s?(s-((Math.ceil(t)+1)*a+8))/t:e,y=(e,t,a)=>{let o=a?3:2,i=t?5:o,n=t?s:l,r=t?S:d,c=n*i+r*i-(t||!t&&a?12:6);if(!e)return c;for(let t=i;t>=2;t-=1)if(e>c)break;else c=n*t+r*t;return c};function A(e){let t=Object.values(e.videos?.video_list??{}).find(e=>"number"==typeof e.width&&"number"==typeof e.height);return t?{width:t.width,height:t.height}:{width:0,height:0}}function C(e){return!!(e&&"is_premiere"in e&&e.is_premiere&&"videos"in e&&e.videos)}},219843(e,t,a){a.d(t,{A:()=>s});function s(e,t){if(!t)return e;let a=new RegExp(/http(s?):/);if(!a.test(e)){let s=a.exec(t);s&&s.length&&(e=s[0]+e)}return e}},588628(e,t,a){a.d(t,{A:()=>l,e:()=>i});var s=a(296540);let o=()=>{let[e,t]=(0,s.useState)(!1),[a,o]=(0,s.useState)(!1),[i,l]=(0,s.useState)(!1);return{active:e,focused:a,hovered:i,onBlur:()=>{o(!1),t(!1)},onFocus:()=>o(!0),onMouseDown:()=>t(!0),onMouseEnter:()=>l(!0),onMouseLeave:()=>{l(!1),t(!1)},onMouseUp:()=>t(!1)}};function i({children:e}){return e(o())}let l=o},582301(e,t,a){a.d(t,{P:()=>s,y:()=>o});let{Provider:s,getMaybe:o}=(0,a(697384).A)("PinCreateDeleteContext")},243042(e,t,a){a.d(t,{_G:()=>c,oh:()=>d});var s=a(97407),o=a(296540),i=a(532189),l=a(474848);let n={showCloseupContentRight:!0,showProductDetailPage:!1,viewportSize:"lg",paneWidth:i.qr,maxWidth:i.QH,descriptionPaneWidth:i.QH-i.qr,isCommentAttachmentSelectorOpen:!1,isCommentComposerFocused:!1,isCommentPopoverInteractionActive:!1,isCommentThreadExpanded:!1,isCloseupMediaViewerOpen:!1,isMediaViewerOpen:!1,isShoppingModuleExpanded:!1,closeupWithinMasonryEnabled:!1,peekCloseupEnabled:!1,calculatedImageHeight:0,setAbortNoActionPlacementTimeout:()=>{},setIsCloseupMediaViewerOpen:()=>{},setIsCommentAttachmentSelectorOpen:()=>{},setIsCommentComposerFocused:()=>{},setIsCommentPopoverInteractionActive:()=>{},setIsMediaViewerOpen:()=>{},setIsShoppingModuleExpanded:()=>{},setCalculatedImageHeight:()=>{},setViewportSize:()=>{}},r=(0,o.createContext)(n);function d({children:e,value:t}){(0,o.useEffect)(()=>{(0,s.A)("Context","/app/www/closeup/desktop/Context.tsx")},[]);let a=(0,o.useMemo)(()=>({...n,...t}),[t]);return(0,l.jsx)(r,{value:a,children:e})}function c(){let e=(0,o.use)(r);if(!e)throw Error("useCloseupContext must be used within CloseupContextProvider");return e}},532189(e,t,a){a.d(t,{DG:()=>n,Em:()=>b,En:()=>g,Ii:()=>y,M1:()=>p,MI:()=>S,QH:()=>i,Ye:()=>c,Z:()=>_,bZ:()=>h,bo:()=>l,gr:()=>P,h3:()=>d,n0:()=>u,nb:()=>m,qr:()=>o,t4:()=>A,tb:()=>r,vg:()=>v,w$:()=>f});var s=a(328138);let o=508,i=1016,l=488,n=992,r=672,d=1176,c=40,u=72,p=740,_=32,h=16,m=24,v=2,S=1,b=new s.rk(5),f={ARTICLE:"https://schema.org/Article",BRAND:"https://schema.org/Brand",PRODUCT:"https://schema.org/Product",RECIPE:"https://schema.org/Recipe",OFFER:"https://schema.org/Offer",OUT_OF_STOCK:"https://schema.org/OutOfStock",PERSON:"https://schema.org/Person"},g={boxShadow:"0 2px 5px rgba(0, 0, 0, 0.06)",transition:"box-shadow 200ms ease-in-out"},P="calc(90vh - 80px)",y="calc(55vh + 80px)",A="calc(75vh - 80px)"},340577(e,t,a){a.d(t,{A:()=>c});var s=a(97407),o=a(296540),i=a(328138),l=a(643357),n=a(327467),r=a(243042),d=a(474848);function c({accessibilityControls:e,accessibilityExpanded:t,accessibilityHaspopup:a,dropdownRef:c,hideDropdown:u=!1,isSaved:p,onBoardDropdownClick:_,onSaveClick:h,promotedIsLeadAd:m,renderPinSaveTooltip:v,selectedTitle:S,showBoardFlyout:b,unselectedText:f,view:g,surface:P}){(0,o.useEffect)(()=>{(0,s.A)("BoardSelectionDisplay","/app/www/common/PinBetterSave/BoardSelectionDisplay.tsx")},[]);let[y,A]=(0,o.useState)(!1),C=(0,l.A)(),w=(0,o.useRef)(null),{closeupWithinMasonryEnabled:x}=(0,r._G)();(0,o.useEffect)(()=>{y&&A(!1)},[y]);let I=S||f,k="closeup"===g,E="media-viewer"===g,T="comparison"===g,B="VideoCarouselModule"===P,R=(0,o.useMemo)(()=>T?"inverse":E?b?"inverse":"default":b||!k?"inverse":"default",[k,b,E,T]),z=(0,o.useCallback)(({event:e})=>{_(e)},[_]),O=k?"transparent":"transparentInverse";O=E?"tertiarySemiTransparent":O,O=T?"transparentInverse":O;let j=p?C.bt("Saved", "Saved", "PinBetterSave.BoardSelection.SavedButton", undefined, true):C.bt("Save", "Save", "PinBetterSave.BoardSelection.SaveButton", undefined, true);return(0,d.jsxs)(i.az,{alignItems:E?"start":"center",dangerouslySetInlineStyle:{__style:{gap:"4px"}},display:"flex",paddingX:x?0:void 0,width:"100%",children:[!u&&(0,d.jsx)(i.az,{"data-test-id":S?"board-selection-item-selected":"board-selection-placeholder",flex:"grow",width:"100%",children:(0,d.jsx)(i.$n,{ref:c,accessibilityControls:e,accessibilityExpanded:t,accessibilityHaspopup:a,accessibilityLabel:(0,n.$)(C.bt("Select a board to save to: {{ boardName }}", "Select a board to save to: {{ boardName }}", "PinBetterSave.BoardSelection.DropdownIcon", undefined, true),{boardName:I}),color:O,dataTestId:"PinBetterSaveDropdown",iconEnd:"chevron-down",onClick:z,selected:b,size:B?"sm":"lg",text:(0,d.jsx)(i.KJ,{color:R,lineClamp:1,overflow:"breakAll",size:B?"100":"300",weight:"bold",children:I})})}),(0,d.jsx)(i.az,{alignSelf:k?"center":"start","data-test-id":"PinBetterSaveButton",flex:"none",marginStart:"auto",children:(0,d.jsx)(i.PF,{ref:w,color:m?"secondary":"primary",onClick:({event:e})=>{u?_(e):h(e)},selected:p,size:B?"sm":"lg",text:j})}),!!v&&!!w.current&&k&&v(w.current)]})}},443400(e,t,a){a.d(t,{A:()=>u});var s=a(97407),o=a(296540),i=a(328138),l=a(632321),n=a(55268),r=a(643357),d=a(327467),c=a(474848);function u({boardName:e,boardUrl:t,isBoardlessPin:a,isFromPinBuilder:u,hasNewPin:p,onChangeButtonClick:_,onVisitButtonClick:h=()=>{},onHide:m,onUndo:v,pinImageUrl:S}){let b;(0,o.useEffect)(()=>{(0,s.A)("PostSavedPinToast","/app/www/common/PinBetterSave/PostSavedPinToast.tsx")},[]);let f=(0,r.A)(),{logContextEvent:g}=(0,l.o)();u?b={accessibilityLabel:f.bt("Visit Pin", "Visit Pin", "PostSavedPinToast.a11yVisitButton", undefined, true),label:f.bt("Visit", "Visit", "PostSavedPinToast.VisitButton", undefined, true),size:"lg",onClick:h}:(_||v)&&(b={accessibilityLabel:p&&a&&_?f.bt("Change Pin destination", "Change Pin destination", "PostSavedPinToast.a11yChangeButton", undefined, true):f.bt("Undo saved Pin", "Undo Saved Pin", "PostSavedPinToast.a11yUndoButton", undefined, true),label:p&&a&&_?f.bt("Change", "Change", "PostSavedPinToast.ChangeButton", undefined, true):f.bt("Undo", "Undo", "PostSavedPinToast.UndoButton", undefined, true),size:"lg",onClick:p&&a&&_?()=>_():v});let P=()=>{p&&a&&_&&g({event_type:101,component:14409})};return(0,c.jsx)(n.A,{duration:a?6e3:3e3,imageUrl:S,onHide:m,primaryAction:b,text:(0,c.jsx)(i.KJ,{overflow:"normal",size:"200",children:(0,d.$w)({text:f.bt("Saved to <a id=\"1\">{{ boardName }}</a>", "Saved to <a id=\"1\">{{ boardName }}</a>", "PostSavedPinToast.SavedToBoardToast.Message", undefined, true),markers:{boardName:e??""},jsxReplacements:{1:({innerHtmlStrings:e})=>(0,c.jsx)(i.N_,{display:"block",href:a?"/me/":t??"",onClick:P,children:(0,c.jsx)(i.KJ,{lineClamp:1,size:"200",weight:"bold",children:e},"PostSavedPinToastBoardName")})}})}),thumbnail:a?{icon:(0,c.jsx)(i.In,{accessibilityLabel:f.bt("Saved to profile thumbnail", "Saved to profile thumbnail", "PostSavedPinToast.thumbnail.accessibilityLabel", undefined, true),color:"default",icon:"clock-history",size:24})}:void 0})}},580072(e,t,a){a.d(t,{A:()=>s});function s(e,t){e&&e.includes("~0")&&(e=e.replace("~0",""));let a=t?.includes("~0")?t:`${t||""}~0`;return e&&e.replace("undefined","")?e:a.replace("undefined","")}},584733(e,t,a){function s(e,t){return{type:"CHANGE_CAROUSEL_SLOT_INDEX",payload:{id:e,index:t}}}function o(e,t){return{type:"SET_PIN_COMMENTS_DISABLED",payload:{id:e,pinCommentsDisabled:t}}}function i(e){return{type:"PIN_SAVE",payload:e}}function l(e,t){return{type:"PIN_UNSAVE",payload:{id:e,nodeId:t}}}function n(e){return{type:"PIN_SHOW_SUGGESTED_CREATOR_RECS",payload:{id:e,value:!0}}}function r({id:e,nodeId:t}){return{type:"PIN_SHOW_FEEDBACK",payload:{id:e,value:!1,nodeId:t}}}function d({id:e,text:t,nodeId:a}){return{type:"PIN_SHOW_FEEDBACK",payload:{id:e,value:!0,text:t,nodeId:a}}}function c({id:e,nodeId:t}){return{type:"PIN_SHOW_FEEDBACK_OVERLAY",payload:{id:e,value:!0,nodeId:t}}}function u({id:e,nodeId:t}){return{type:"PIN_SHOW_FEEDBACK_OVERLAY",payload:{id:e,value:!1,nodeId:t}}}function p(e){return{type:"PIN_SHOW_FEWER_WEIGHT_LOSS_ADS_MODAL",payload:{id:e,value:!0}}}function _(e){return{payload:{id:e,value:!1},type:"PIN_SHOW_FEWER_WEIGHT_LOSS_ADS_MODAL"}}a.d(t,{C4:()=>o,H8:()=>r,J4:()=>i,N6:()=>p,NE:()=>_,WG:()=>c,aP:()=>l,aq:()=>d,bd:()=>u,p8:()=>s,qJ:()=>n})},375114(e,t,a){a.d(t,{Bt:()=>c,Fq:()=>p,LR:()=>i,Wi:()=>_,oH:()=>u,om:()=>d,pV:()=>l,yX:()=>n});var s=a(901856),o=a(534907);function i(e){return{type:"UPDATE_USER_PIN_COUNT",payload:e}}let l=(e,t)=>({type:"USER_FOLLOW",payload:{id:e,value:t}}),n=(e,t)=>({type:"USER_FOLLOWING_COUNT",payload:{id:e,following:t}}),r=(e,t)=>({type:"USER_BLOCK",payload:{id:e,value:t}}),d=({id:e,orbacSubjectId:t,blockSource:a,blockContext:o,logContextEvent:i})=>async l=>{l(r(e,!0));let n=await (0,s.A)({url:"/v3/users/{blocked_user}/block/",urlParams:{blocked_user:e},method:"PUT",data:{orbac_subject_id:t,block_source:a,block_context:o}}).catch(()=>l(r(e,!1)));return i({event_type:54,object_id_str:e}),n},c=(e,t)=>async a=>{a(r(e,!1));let o=await (0,s.A)({url:"/v3/users/{blocked_user}/block/",urlParams:{blocked_user:e},method:"DELETE"}).catch(()=>a(r(e,!0)));return t({event_type:55,object_id_str:e}),o};function u(e){return{type:"UPDATE_USER_SCHEDULED_PIN_COUNT",payload:e}}let p=(e,t)=>()=>(0,s.A)({url:"/v3/users/state/{state}/",urlParams:{state:e},method:"PUT",data:{value:t}}),_=(e,t,a)=>(i,l)=>{(0,s.A)({url:"/v3/users/me/",method:"POST"}).then(()=>{a({event_type:48,object_id_str:l().session.userId}),e(),(0,o.A)()},t)}},62923(e,t,a){a.d(t,{a:()=>U});var s,o,i=a(97407),l=a(296540),n=a(671468);a(234784);var r=a(278106),d=a(684059),c=a(632321),u=a(555491),p=a(696561),_=a(72201),h=a(55268),m=a(449798),v=a(698781),S=a(301496),b=a(643357),f=a(581818),g=a(211974),P=a(219843),y=a(367863),A=a(703613),C=a(580072),w=a(582301),x=a(209922),I=a(584733),k=a(375114),E=a(328138),T=a(327467),B=a(67977),R=a(474848),z=a(109968);function O(e,t,a){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:s+"")in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}let j=/#[^(\-\\.\s#,\/$%\^&\*;:{}=\`~()\[\]@|<>â€¦)]+/gi,D=(void 0!==s||(s=a(935850)).hash&&"64132b88edd48497e63c9ad85ae5ab66"!==s.hash&&console.error("The definition of 'PinSaveRequest_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),s),N=(void 0!==o||(o=a(583215)).hash&&"58c24e25a76e7a1c4533f3b07f490517"!==o.hash&&console.error("The definition of 'PinSaveRequest_shuffle_asset' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o);class L extends l.Component{constructor(...e){super(...e),O(this,"state",{boardSavedTo:null,displaySuccessAnimation:!1,newPin:null,modalTitle:this.getModalTitle(this.props.showCreate,!!this.props.boardWithSection),pinDescription:this.props.pin&&this.props.pin.description||this.props.urlPinInfo?.description||"",resolve:void 0,sharing:{facebook:!1,twitter:!1}}),O(this,"unmounted",!1),O(this,"setModalTitle",e=>this.safeSetState({modalTitle:e})),O(this,"updateDescription",e=>{this.safeSetState({pinDescription:e})}),O(this,"close",()=>{let{onClose:e}=this.props;e&&e(),this.props.logContextEvent({event_type:2502,component:5,element:610})}),O(this,"safeSetState",(e,t)=>{this.unmounted?t&&t():this.setState(e,t)}),O(this,"getPinResource",(e,t,a)=>{let{color:s,clientTrackingParams:o,pin:i,method:l,guid:n,additionalCreateFields:r,advertiser_id:c,urlPinInfo:u,shuffleAsset:p}=this.props,_=i?.entityId?"RepinResource":"PinResource",h=i?.imageUrl||u?.imageUrl,m=i?.link||u?.link,v=!i?.entityId&&h?(0,P.A)(h,m):i?.images_orig?.url||"",S={...r,board_id:t||"",color:s||"",clientTrackingParams:(0,C.A)(o,i?.trackingParams),description:this.state.pinDescription,guid:n||"",link:m,image_base64:i?.imageBase64??void 0,image_url:v,is_buyable_pin:!1,is_removable:i?.promotedIsRemovable??void 0,media_upload_id:i?.mediaUploadId??void 0,method:l||"",pin_id:i?.entityId||"",section:a,title:i?.title||"",...c?{advertiser_id:c}:Object.freeze({}),...p?{shuffle_asset:p.entityId}:{}};if(!e){let{facebook:e,twitter:t}=this.state.sharing;S.share_facebook=e,S.share_twitter=t}return d.A.create(_,S)}),O(this,"triggerPubSubs",e=>{this.props.onPinCreate&&this.props.onPinCreate({boardId:e.board.id,pinId:e.id})}),O(this,"makeCancelablePromise",e=>{let t=!1;return{promise:new Promise((a,s)=>{e.then(e=>t?s({isCanceled:!0}):a(e)),e.catch(e=>t?s({isCanceled:!0}):s(e))}),cancel(){t=!0}}}),O(this,"handleLogToastClick",()=>{this.props.logContextEvent({event_type:101,component:20,view_type:52})}),O(this,"showBoardSavedToast",(e,t)=>{let{toastManagerContext:a,i18n:s}=this.props;a.showToast(({hideToast:a})=>{var o;return(0,R.jsx)(h.A,{duration:z.e,href:t?`${e.url??""}${t.slug??""}`:e.url,imageUrl:e.image_cover_url??"",onClick:this.handleLogToastClick,onHide:a,text:(o=e.name,t?(0,B.A)(s.bt("Saved to {{sectionName}} in {{boardName}}", "Saved to {{sectionName}} in {{boardName}}", "Toast for successfully saving to a section within a board", undefined, true),{sectionName:t.title??"",boardName:o??""}):(0,R.jsx)(E.KJ,{children:(0,T.$w)({text:s.bt("Saved to <strong id=\"1\">{{ boardName }}</strong>", "Saved to <strong id=\"1\">{{ boardName }}</strong>", "PinToBoard.Lib.SavedToBoardToast.Message", undefined, true),markers:{boardName:o??""},jsxReplacements:{1:({innerHtmlStrings:e})=>(0,R.jsx)(E.KJ,{weight:"bold",children:e})}})}))})})}),O(this,"dismissModal",()=>{let{resolve:e,newPin:t}=this.state;e&&e(t)}),O(this,"handleBoardSaveSuccess",(e,t,a,s)=>{let{action:o,saveToBoard:i,dispatch:l,pin:n,setCompletionPromise:r,shouldShowToast:d,showRepinAnimation:c,viewerUserId:u,urlPinInfo:p}=this.props;l((0,_.$O)());let h=e.resource_response.data,m=this.makeCancelablePromise(new Promise(e=>{this.triggerPubSubs(h);let o=this.state.pinDescription.match(j)||[];o.length>0&&this.props.logContextEvent({event_type:2,element:10273,object_id_str:this.props.pin?.entityId,aux_data:{hashtags:JSON.stringify(o)}});let i=()=>{d&&this.showBoardSavedToast(t,a),this.safeSetState({displaySuccessAnimation:!0,modalTitle:this.props.i18n.bt("Board created", "Board created", "Modal title after creating a new board", undefined, true),newPin:h,resolve:e})};s?i():e(h)}));!s&&n?.entityId&&c(n.entityId),r(m),i(t),l((0,x.zY)({boardId:t.id,sectionId:a&&a.id,increment:1})),u&&(l((0,k.LR)({userId:u,increment:1})),l((0,_.$O)())),(a||!t.image_cover_url)&&(t.image_cover_url=n?.imageUrl||p?.imageUrl||n?.images_236x?.url||"",l((0,x.NQ)(t))),a&&l((0,f.J)("BoardSectionResource",{options:{field_set_key:"board_page",section_id:a.id}})),n?.entityId&&l((0,I.J4)({id:n.entityId,nodeId:n.__id,boardId:t.id,title:t.name??"",url:t.url??"",localPinId:h.id}))}),O(this,"handleSaveToBoard",(e,t,a)=>{let{onToggleModal:s,shouldShowToast:o,mountAfterActionPlacement:i}=this.props;o&&!a&&(this.close(),this.showBoardSavedToast(e,t));let l="secret"===(e.privacy||""),n={board:t?t.id:e.id,state:z.J.LOADING};this.safeSetState({boardSavedTo:n},()=>{this.getPinResource(l,e.id,(t||{}).id).callCreate({showError:!1}).then(o=>{i("Save",{pin_id:this.props.pin?.entityId,is_promoted:this.props.pin?.isPromoted}),this.safeSetState({boardSavedTo:Object.assign(n,{state:z.J.SUCCESS})},()=>this.handleBoardSaveSuccess(o,e,t,a)),s&&!a&&s(!1)}).catch(e=>{this.unmounted||this.safeSetState({boardSavedTo:null}),u.A.showError(e.message_detail||e.message);let t=this.makeCancelablePromise(Promise.reject(e));this.props.setCompletionPromise(t),s&&s(!1)})})}),O(this,"handleNewBoardAnimationCompletion",()=>{let{pin:e,showRepinAnimation:t}=this.props;e?.entityId&&t(e.entityId)})}getModalTitle(e,t){if(e)if(t)return this.props.i18n.bt("Create section", "Create section", "modal title for create section pane", undefined, true);else return this.props.i18n.bt("Create board", "Create board", "Repin title for making a new board", undefined, true);return t?this.props.i18n.bt("Choose section", "Choose section", "modal title for choose section", undefined, true):this.props.i18n.bt("Choose board", "Choose board", "Repin title for choosing a board", undefined, true)}componentDidUpdate(e){let{boardWithSection:t,showCreate:a,pin:s,urlPinInfo:o,description:i}=this.props,l={};(s!==e.pin||o!==e.urlPinInfo||i!==e.description)&&(l.pinDescription=s?.description||o?.description||i||""),(a!==e.showCreate||t!==e.boardWithSection)&&(l.modalTitle=this.getModalTitle(a,!!t)),Object.keys(l).length>0&&this.safeSetState(l)}componentWillUnmount(){this.unmounted=!0}render(){let{close:e,dismissModal:t,handleNewBoardAnimationCompletion:a,handleSaveToBoard:s,setModalTitle:o,updateDescription:i}=this,{boardSavedTo:l,displaySuccessAnimation:n,modalTitle:r,newPin:d}=this.state,{color:c}=this.props;return this.props.children({boardSavedTo:l,color:c,dismissModal:t,displaySuccessAnimation:n,handleAbort:e,handleNewBoardAnimationCompletion:a,handleSaveToBoard:s,modalTitle:r,newPin:d,setModalTitle:o,updateDescription:i})}componentDidMount(){(0,i.A)("PinSaveRequest","/app/www/save/pin-to-board/PinSaveRequest.tsx")}}function U({pinKey:e,shuffleAssetKey:t,...a}){(0,l.useEffect)(()=>{(0,i.A)("PinSaveRequest","/app/www/save/pin-to-board/PinSaveRequest.tsx")},[]);let{saveToBoard:s}=(0,A.p)(),{logContextEvent:o}=(0,c.o)(),d=(0,w.y)()?.onPinCreate,u=(0,b.A)(),_=(0,r.zy)(),h=(0,m.A)(),f=(0,g.CG)(),P=(0,n.wA)(),{updateHeaderState:C}=(0,y.A)(),x=(0,n.d4)(({advertiser:e})=>h.isAuth&&e&&e.owner_user_id!==h.id?e.id:void 0),{previous:I}=(0,S.qD)(),k=(0,p.Ts)(),E=(0,v.A)(D,e),T=(0,v.A)(N,t);return(0,R.jsx)(L,{...a,advertiser_id:x,dispatch:P,i18n:u,location:_,logContextEvent:o,mountAfterActionPlacement:k,onPinCreate:d,pin:E,previousHistory:I,saveToBoard:s,showRepinAnimation:e=>C({type:"showRepinAnimation",payload:e}),shuffleAsset:T,toastManagerContext:f,viewerUserId:h.isAuth?h.id:void 0})}},109968(e,t,a){a.d(t,{J:()=>o,e:()=>s});let s=4e3,o={LOADING:"loading",SUCCESS:"success"}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/91042.en_GB-1cf759ae84d83022.mjs.map