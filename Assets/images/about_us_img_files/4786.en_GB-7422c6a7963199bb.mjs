(self.modernJsonp=self.modernJsonp||[]).push([["4786"],{131510(e,i,t){t.r(i),t.d(i,{default:()=>n});let a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DeprecatedCarousel_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{args:null,kind:"FragmentSpread",name:"usePinCarouselData_pin"}],type:"Pin",abstractKey:null};a.hash="4be444081491499e2b6e9d6768314918";let n=a},348941(e,i,t){var a,n,l;t.r(i),t.d(i,{default:()=>s});let r={argumentDefinitions:[{kind:"RootArgument",name:"isCloseupRelatedModulesFeedQuery"}],kind:"Fragment",metadata:null,name:"PinImage_pin",selections:[{condition:"isCloseupRelatedModulesFeedQuery",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"altText",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"autoAltText",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isThirdPartyAd",storageKey:null}]},{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:"images_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l=[a={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"236x")'},{alias:"images_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l,storageKey:'images(spec:"474x")'},{alias:"images_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l,storageKey:'images(spec:"736x")'},{alias:"images_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l,storageKey:'images(spec:"orig")'},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},n],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{args:null,kind:"FragmentSpread",name:"StoryPinImage_pin"},{args:null,kind:"FragmentSpread",name:"DeprecatedCarousel_pin"}],type:"Pin",abstractKey:null};r.hash="b72e53fc9b1cccd8cf55dbe222ad1fed";let s=r},253711(e,i,t){t.r(i),t.d(i,{default:()=>n});let a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PinVideoWithVisibility_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null},{args:null,kind:"FragmentSpread",name:"PinVideo_pin"},{args:null,kind:"FragmentSpread",name:"useAutoplayOrgVideoOnHover_pin"}],type:"Pin",abstractKey:null};a.hash="8e6a9272e57ad1033c4bf432c3adf854";let n=a},968499(e,i,t){var a,n,l;t.r(i),t.d(i,{default:()=>s});let r=(a={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},l=[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PinVideo_pin",selections:[a,{alias:"images_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[n],storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"isDownstreamPromotion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForWebCloseup",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"promoter",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[a,{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHEVCMP4T1V2",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHEVCMP4T2V2",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHEVCMP4T3V2",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHEVCMP4T4V2",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHEVCMP4T5V2",plural:!1,selections:l,storageKey:null}],storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PinImage_pin"}],type:"Pin",abstractKey:null});r.hash="c46c1b6ca5de0c3e7b77febdfc59a7e1";let s=r},100982(e,i,t){var a,n,l,r;t.r(i),t.d(i,{default:()=>o});let s=(r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinImage_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:"images_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l=[a={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"474x")'},{alias:"images_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:l,storageKey:'images(spec:"736x")'},{alias:null,args:null,kind:"ScalarField",name:"isDownstreamPromotion",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"promoter",plural:!1,selections:[r],storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinPage",kind:"LinkedField",name:"pages",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blocks",plural:!0,selections:[r,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"blockType",storageKey:null},{alias:null,args:null,concreteType:"StoryPinVideoMetadataFormattedV2",kind:"LinkedField",name:"videoDataV2",plural:!1,selections:[{alias:null,args:[{kind:"Literal",name:"version",value:"V_HLSV3_MOBILE"}],concreteType:"StoryPinVideoFormatsV2",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV3MOBILE",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},n],storageKey:null}],storageKey:'videoList(version:"V_HLSV3_MOBILE")'}],storageKey:null}],type:"StoryPinVideoBlock",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null});s.hash="1758841fd37f8b2558f32f33ba6ddc33";let o=s},879436(e,i,t){t.r(i),t.d(i,{default:()=>n});let a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoWithContextLogging_pin",selections:[{args:null,kind:"FragmentSpread",name:"VideoWrapper_pin"}],type:"Pin",abstractKey:null};a.hash="93ed23334d5bac81ac8410f05c4f2031";let n=a},382521(e,i,t){var a,n;t.r(i),t.d(i,{default:()=>r});let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useAutoplayOrgVideoOnHover_pin",selections:[a={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"totalVideoDuration",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[a,{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"v720P",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV3MOBILE",plural:!1,selections:n,storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};l.hash="2942f85ec1d9274bd2a1e72a4b5cf008";let r=l},211561(e,i,t){t.r(i),t.d(i,{default:()=>ee});var a,n,l,r,s,o=t(97407),d=t(296540);t(234784);var u=t(328138),h=t(278106),c=t(246942),g=t.n(c),p=t(214476),m=t(186029),y=t(698781),v=t(643357),f=t(327467),x=t(939043),_=t(622165),b=t(603212),k=t(474848);function w(e){return!(e.images_474x?.width&&e.images_474x.height&&e.images_474x.width>e.images_474x.height)&&e.images_474x||e.images_736x}let P=(void 0!==a||(a=t(100982)).hash&&"1758841fd37f8b2558f32f33ba6ddc33"!==a.hash&&console.error("The definition of 'StoryPinImage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),a);function T({alt:e,fetchPriority:i,onError:t=()=>{},onLoad:a=()=>{},pinKey:n,_fixCompletedOnLoad:l}){let r,s;(0,d.useEffect)(()=>{(0,o.A)("StoryPinImage","/app/www/AuthDesktopPinRep/components/StoryPinImage.tsx")},[]);let{checkExperiment:h}=(0,_.A)(),{anyEnabled:c}=h("ads_iad_dweb"),g=(0,y.A)(P,n),{dominantColor:p,isDownstreamPromotion:m,promoter:v}=g,f=!!v&&!m,x=(r=g.storyPinData?.pages||[],"StoryPinVideoBlock"===(s=(r[0]?.blocks||[])[0]||{}).__typename&&3===s.blockType),{height:T,width:V,url:S}=function({pin:e,useVideoThumbnail:i}){let t,a,n;return i?(t=e.storyPinData?.pages||[],a=t[0]?.blocks||[],n=a[0]?.__typename==="StoryPinVideoBlock"?a[0]?.videoDataV2?.videoList?.vHLSV3MOBILE:null,n?.thumbnail?{height:n?.height||0,width:n?.width||0,url:n.thumbnail||""}:w(e)):w(e)}({pin:g,useVideoThumbnail:x&&(f&&c||!f)})??{};return(0,k.jsx)(u.az,{dangerouslySetInlineStyle:{__style:{zIndex:b.A.storyPinImage}},"data-test-id":"story-pin-image-box",width:"100%",children:S&&(0,k.jsx)(u._V,{_fixCompletedOnLoad:l,alt:e,color:p||"transparent",fetchPriority:i,naturalHeight:T??1,naturalWidth:V??1,onError:t,onLoad:a,src:S})})}var V=t(965485),S=t(956363),L=t(271028);let C=["ShoppingCarousel","ShoppingGridSmall","ShoppingGridSmallCarousel","ShoppingDynamicHeightGrid","VisualInspirationFocusPin","VisualInspirationPin","VisualInspirationShoppingPin","ProductTaggingSearchResult"],I=(void 0!==n||(n=t(348941)).hash&&"b72e53fc9b1cccd8cf55dbe222ad1fed"!==n.hash&&console.error("The definition of 'PinImage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),F=({children:e,cropStoryPinImage:i,cropWidth:t,cropHeight:a})=>i?(0,k.jsx)(u.so,{alignItems:"center",height:t?a:void 0,justifyContent:"start",width:t||void 0,children:e}):(0,k.jsx)(u.az,{children:e}),A=({cropHeight:e,cropWidth:i,highResOnly:t,imageFit:a,isInDesktopCarousel:n,onError:l,onLoad:r,pinKey:s,saved:c=!1,surface:_,ssrImpressionFixEnabled:b})=>{(0,d.useEffect)(()=>{(0,o.A)("PinImage","/app/common/react/components/PinRep/components/PinVisual/PinImage.tsx")},[]);let w=(0,v.A)(),P=(0,V.g)((0,h.zy)()),A=(0,y.A)(I,s),{altText:D,autoAltText:E,carouselData:K,description:j="",dominantColor:W,gridTitle:z,isThirdPartyAd:H,title:M,videos:R}=A,B=(0,f.vQ)(w.bt("This contains an image of: {{ pinTitle }}", "This contains an image of: {{ pinTitle }}", "web.altText", undefined, true),{pinTitle:M||z}).join(""),O="",$,N=0,U=0;if(A.images_736x||A.images_orig||A.images_474x||A.images_236x){let e=A.images_236x;if(t)e=A.images_736x||A.images_orig||A.images_474x||A.images_236x;else{let{thumbnail:i,height:t,width:a}=R?.videoList?.vHLSV4||{};e=i?{url:i,height:t??1,width:a??1}:e}N=e?.height,U=e?.width,O=e?.url,$=t?e?.url?`${e.url} 1x`:"":[A.images_236x?.url&&`${A.images_236x.url} 1x`,A.images_474x?.url&&`${A.images_474x.url} 2x`,A.images_736x?.url&&`${A.images_736x.url} 3x`,A.images_orig?.url&&`${A.images_orig.url} 4x`].filter(Boolean).join(", ")}let G=(0,p.A)({altText:D,autoAltText:E,i18n:w})||!!j?.trim().length&&j||B;if(K)return(0,k.jsx)(S.A,{_fixCompletedOnLoad:b,highResOnly:t,isThirdPartyAd:H,onError:l,onLoad:r,pinKey:A});let q=["ShoppingGridSmall","ShoppingGridSmallCarousel"].includes(_)?void 0:x.sj,Q=(0,L.A)(_),J="non-story-pin-image";return(0,k.jsx)(u.so,{alignItems:"center",justifyContent:"start",minHeight:q,children:(0,k.jsx)(u.az,{flex:"grow",children:(0,k.jsx)("div",{className:g()({savedGradient:c}),children:A.storyPinDataId?(0,k.jsx)(F,{cropHeight:e,cropStoryPinImage:!!i&&(C.includes(_)||!!n),cropWidth:i,children:(0,k.jsx)(T,{_fixCompletedOnLoad:b,alt:G,fetchPriority:P?"low":void 0,onError:l,onLoad:r,pinKey:A})}):(0,k.jsx)(u.az,{"data-test-id":J,height:i?e:void 0,width:i||void 0,children:(0,k.jsx)(m.A,{_fixCompletedOnLoad:b,alt:G,color:"dominant"===Q?W??"":Q,crossOrigin:H?"anonymous":void 0,elementTiming:`grid-${J}-${_}`,fetchPriority:P?"low":void 0,fit:a,naturalHeight:N??1,naturalWidth:U??1,onError:l,onLoad:r,src:O??"",srcSet:$})})})})})};var D=t(723062),E=t(76166),K=t(212280),j=t(745293),W=t(766284);let z={__style:{backgroundColor:"#000"}};function H({backgroundImage:e,naturalHeight:i,naturalWidth:t,onRestartVideo:a,pinId:n}){(0,d.useEffect)(()=>{(0,o.A)("PinVideoEndCard","/app/www/AuthDesktopPinRep/PinVideoEndCard.tsx")},[]);let l=(0,v.A)();return(0,k.jsxs)(u._V,{alt:l.bt("Pin image", "pin image", "image of a pin", undefined, true),naturalHeight:i,naturalWidth:t,src:e,children:[(0,k.jsx)(u.az,{bottom:!0,dangerouslySetInlineStyle:z,left:!0,opacity:80,position:"absolute",right:!0,top:!0}),(0,k.jsxs)(u.az,{"data-test-id":`video-end-card-${n}`,direction:"column",display:"flex",height:"100%",justifyContent:"center",position:"absolute",width:"100%",children:[(0,k.jsx)(u.Rp,{rounding:200,children:(0,k.jsxs)(u.az,{display:"flex",justifyContent:"center",padding:2,children:[(0,k.jsx)(u.In,{accessibilityLabel:l.bt("Visit site", "Visit site", "Button when pressed goes to pin's website", undefined, true),color:"light",dangerouslySetSvgPath:{__path:j.A},size:25}),(0,k.jsx)(u.az,{margin:1}),(0,k.jsx)(u.KJ,{color:"light",lineClamp:1,weight:"bold",children:l.bt("Visit site", "Visit site", "Button when pressed goes to pin's website", undefined, true)})]})}),(0,k.jsx)(u.az,{margin:3}),(0,k.jsx)(u.Rp,{onTap:a,rounding:200,children:(0,k.jsxs)(u.az,{display:"flex",justifyContent:"center",padding:2,children:[(0,k.jsx)(u.In,{accessibilityLabel:l.bt("Watch again", "Watch again", "Button when pressed restarts the video", undefined, true),color:"light",dangerouslySetSvgPath:{__path:W.A},size:25}),(0,k.jsx)(u.az,{margin:1}),(0,k.jsx)(u.KJ,{color:"light",lineClamp:1,weight:"bold",children:l.bt("Watch again", "Watch again", "Button when pressed restarts the video", undefined, true)})]})})]})]})}function M({aspectRatio:e,children:i}){return(0,d.useEffect)(()=>{(0,o.A)("VideoAspectRatioWrapper","/app/www/video/VideoAspectRatioWrapper.tsx")},[]),(0,k.jsx)(u.az,{dangerouslySetInlineStyle:{__style:{aspectRatio:e}},children:i})}var R=t(916403);let B=new Set(["ConversationView","TodayTabFeed"]),O=(void 0!==l||(l=t(968499)).hash&&"c46c1b6ca5de0c3e7b77febdfc59a7e1"!==l.hash&&console.error("The definition of 'PinVideo_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function $({isAutoplay:e,cropHeight:i,currentTime:t,highResOnly:a,onLoad:n,onError:l,saved:r,onTimeChange:s,isExperimentalPinRep:h,pinKey:c,surface:g,playing:p,rootMargin:m,viewType:v,viewParameter:f,cropWidth:x,video:b}){let w,P;(0,d.useEffect)(()=>{(0,o.A)("PinVideo","/app/common/react/components/PinRep/components/PinVisual/PinVideo.tsx")},[]);let[T,V]=(0,d.useState)(!1),[S,L]=(0,d.useState)(!p),C=(0,y.A)(O,c),{checkExperiment:I}=(0,_.A)(),[F,j]=(0,d.useState)(!1);(0,d.useEffect)(()=>{j(I("ads_rain_magnite_web_video").anyEnabled)},[I]);let{isDownstreamPromotion:W,promoter:z}=C,$=(0,D.kx)(!!W,!!z),N=$&&!C.isEligibleForWebCloseup,U=h&&$&&C.isEligibleForWebCloseup&&!B.has(g),{setCurrentVideo:G}=(0,E.Y)(),q=!!U&&I("ads_web_disable_video_end_card").anyEnabled;e&&p&&S&&L(!1);let{url:Q}=C.images_236x??{},{entityId:J,isPromoted:Y}=C,X=(0,d.useCallback)(({event:e})=>{e.preventDefault(),e.stopPropagation(),G({pinId:J,isPromoted:!!Y,currentTime:0}),V(!1)},[Y,J,G]),Z=(0,d.useCallback)(()=>{!Y||q||V(U)},[Y,U,q]),ee=b??C.videos?.videoList?.vHLSV4,ei=!1;if(!ee&&F&&(ee=C.videos?.videoList?.vHEVCMP4T4V2??C.videos?.videoList?.vHEVCMP4T5V2??C.videos?.videoList?.vHEVCMP4T3V2??C.videos?.videoList?.vHEVCMP4T2V2??C.videos?.videoList?.vHEVCMP4T1V2)&&(ei=!0),!ee&&F){let e=C.videos?.video_list;e&&(ee=e.V_HEVC_MP4_T4_V2??e.V_HEVC_MP4_T5_V2??e.V_HEVC_MP4_T3_V2??e.V_HEVC_MP4_T2_V2??e.V_HEVC_MP4_T1_V2)&&(ei=!0)}if(!ee)return null;let{height:et,thumbnail:ea,width:en,url:el}=ee,er=b?.entityId??C.videos?.entityId??"",es=ei?"video/mp4":"video/m3u8",eo=(en??1)/(et??1);if(void 0!==x&&void 0!==i&&null!==x&&null!==i){let e="string"==typeof x?parseFloat(x):x,t="string"==typeof i?parseFloat(i):i;Number.isFinite(e)&&Number.isFinite(t)&&e>0&&t>0&&(eo=e/t,P="cover")}let ed=g&&(0,K.A)(g)&&"UserProfilePinGrid"!==g;if(ed&&(eo=1,w="transparent"),"VideoCarouselModule"===g&&(P="cover",eo=(x??en??1)/(i??et??1)),T&&$)return(0,k.jsx)(u.az,{children:(0,k.jsx)(H,{backgroundImage:Q??"",naturalHeight:et??1,naturalWidth:en??1,onRestartVideo:X,pinId:J})});let eu={highResOnly:a,onError:l,onLoad:n,pinKey:C,saved:r};ed&&(eu={...eu,cropHeight:i,cropWidth:x,imageFit:"contain"});let eh=(0,k.jsx)(u.az,{"data-test-id":"pinrep-video--placeholder","data-test-image-signature":Q,children:(0,k.jsx)(M,{aspectRatio:eo,children:(0,k.jsx)(A,{...eu,ssrImpressionFixEnabled:!1,surface:g})})});return S?eh:(0,k.jsx)(u.az,{children:(0,k.jsx)(R.Ay,{aspectRatio:eo,backgroundColor:w,captions:"",contextLogData:{viewParameter:f,component:0,objectId:J,video_id:er,view:v},fallback:eh,hlsConfig:{capLevelToPlayerSize:!0,startPosition:t||-1},isAutoPlay:!!e,loop:N||!h||!$||q,objectFit:P,onEnded:Z,onPlay:()=>{},onPlayError:()=>{},onTimeChange:s,playing:p,poster:Q||ea||void 0,rootMargin:m,src:[{type:es,src:el}]??[],surface:g,videoStartTime:t,volume:0})})}var N=t(568677),U=t(94047),G=t(866127),q=t(699383);let Q=(void 0!==r||(r=t(382521)).hash&&"2942f85ec1d9274bd2a1e72a4b5cf008"!==r.hash&&console.error("The definition of 'useAutoplayOrgVideoOnHover_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);var J=t(719594);function Y(e,i,t){var a;return(i="symbol"==typeof(a=function(e,i){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,i||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(e)}(i,"string"))?a:a+"")in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}let X=(void 0!==s||(s=t(253711)).hash&&"8e6a9272e57ad1033c4bf432c3adf854"!==s.hash&&console.error("The definition of 'PinVideoWithVisibility_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),s);class Z extends d.Component{constructor(...e){super(...e),Y(this,"calculateCurrentVideoTime",()=>{let{currentTimeFromPinRep:e,pin:i,videosAutoplaying:t}=this.props,{entityId:a}=i,n=(0,G.A)(a,t);return this.currentVideoCurrentTime||n||e}),Y(this,"handleVisibilityChanged",(e,i)=>{let{currentTimeFromPinRep:t,pin:a,setCurrentVideo:n,pauseAutoplay:l,videosAutoplaying:r}=this.props,{entityId:s,isPromoted:o}=a,d=(0,q.A)(s,r),u=function(e,i){let{organicVideosAutoplaying:t,promotedVideosAutoplaying:a}=i,n={...t,...a};for(let i in n){let{paused:t}=n[i];if(i!==e&&!t)return!1}return!0}(s,r);e?o?n({pinId:s,isPromoted:o,currentTime:this.calculateCurrentVideoTime()}):(u||"VideoCarouselModule"===i)&&n({pinId:s,isPromoted:!!o,currentTime:this.calculateCurrentVideoTime(),surface:i}):!e&&d&&l({pinId:s,isPromoted:!!o,currentTime:t||this.currentVideoCurrentTime,surface:i})}),Y(this,"handleVideoTimeChange",e=>{let{pin:i,onTimeChange:t,videosAutoplaying:a}=this.props,{entityId:n}=i;(0,q.A)(n,a)&&(this.currentVideoCurrentTime=e.time),t&&t(e)})}componentDidMount(){this.props.onLoad&&this.props.onLoad()}componentDidUpdate(e){let{appInFocus:i}=e,{appInFocus:t,currentTimeFromPinRep:a,pauseAutoplay:n,pin:l,setCurrentVideo:r,videosAutoplaying:s}=this.props,{entityId:o,isPromoted:d}=l,u=(0,q.A)(o,s);t!==i&&!t&&u?(this.pausedDueToBrowserOutOfFocus=!0,n({pinId:o,isPromoted:!!d,currentTime:a||this.currentVideoCurrentTime})):this.pausedDueToBrowserOutOfFocus&&t&&(this.pausedDueToBrowserOutOfFocus=!1,r({pinId:o,isPromoted:!!d,currentTime:this.calculateCurrentVideoTime()}))}componentWillUnmount(){let{currentTimeFromPinRep:e,pauseAutoplay:i,pin:t,videosAutoplaying:a}=this.props,{entityId:n,isPromoted:l}=t;(0,q.A)(n,a)&&i({pinId:n,isPromoted:!!l,currentTime:e||this.currentVideoCurrentTime})}render(){let{cropHeight:e,isAutoplay:i,pin:t,surface:a,videosAutoplaying:n,viewParameter:l,viewType:r,highResOnly:s,onError:o,onLoad:d,saved:u,isExperimentalPinRep:h,rootMargin:c,cropWidth:g,video:p}=this.props,{entityId:m}=t,y=(0,G.A)(m,n),v=(0,q.A)(m,n),f={cropHeight:e,rootMargin:c,currentTime:y,isAutoplay:i,viewParameter:l,viewType:r,onTimeChange:this.handleVideoTimeChange,onVisibilityChanged:e=>this.handleVisibilityChanged(e,a),pinKey:t,surface:a,playing:v&&i,trackFullVisible:!1,highResOnly:s,onError:o,onLoad:d,saved:u,isExperimentalPinRep:h,cropWidth:g,...p?{video:p}:{}};return(0,k.jsx)(U.A,{onVisibilityChanged:e=>this.handleVisibilityChanged(e,a),rootMargin:c,trackFullVisible:f.trackFullVisible,children:(0,k.jsx)($,{...f})})}}function ee({pinKey:e,isHovering:i=!1,...t}){(0,d.useEffect)(()=>{(0,o.A)("PinVideoWithVisibility","/app/common/react/components/PinRep/components/PinVisual/PinVideoWithVisibility.tsx")},[]);let{appUI:{appInFocus:a,isAutoplay:n,videosAutoplaying:l},pauseAutoplay:r,setCurrentVideo:s}=(0,E.Y)(),u=(0,y.A)(X,e),h=(0,N.qJ)(),c=(0,J.A)({isDesktop:h}),g=(0,d.useRef)(i);return!function({pinKey:e,isHovering:i,hoverState:t,disabled:a=!1}){let n=(0,y.A)(Q,e),{setCurrentVideo:l,pauseAutoplay:r,appUI:{videosAutoplaying:s}}=(0,E.Y)(),o=n?.videos?.videoList?.v720P||n?.videos?.videoList?.vHLSV4||n?.videos?.videoList?.vHLSV3MOBILE;(0,d.useEffect)(()=>{if(n&&!a){if(t.current!==i){let{entityId:e,isPromoted:t,storyPinData:a}=n,d=(0,G.A)(e,s);if(o||a?.totalVideoDuration)if(i){let i=function(e,i){let{currentlyPlayingOrganicVideoId:t,organicVideosAutoplaying:a}=i;return t&&t!==e?t:Object.keys(a).find(e=>!1===a[e].paused)}(e,s);i&&r({currentTime:d,pinId:i,isPromoted:!1}),l({currentTime:d,pinId:e,isPromoted:!!t})}else t||r({currentTime:d,pinId:e,isPromoted:!!t})}t.current=i}},[i,t,r,n,l,o,s,a])}({pinKey:u,isHovering:i,hoverState:g,disabled:c}),(0,k.jsx)(Z,{...t,appInFocus:a,isAutoplay:n,pauseAutoplay:r,pin:u,setCurrentVideo:s,videosAutoplaying:l})}},984273(e,i,t){t.d(i,{A:()=>a});function a(e,i,t){let a,n,l,r=!!t?.leading,s=t?.trailing!==!1,o=t?.maxWait?Math.max(t.maxWait,i):void 0,d=null,u=0;function h(i){let t=a;return a=void 0,u=i,t&&(n=e(...t)),n}function c(e){let t=e-(l??0),a=e-u;return void 0===l||t>=i||t<0||void 0!==o&&a>=o}function g(){let e=Date.now();if(c(e))(d=null,s&&a)?h(e):a=void 0;else{let t,a,n;d=setTimeout(g,(t=e-(l??0),a=e-u,n=i-t,void 0!==o?Math.min(n,o-a):n))}}function p(){null!==d&&clearTimeout(d),d=setTimeout(g,i)}function m(...e){let t=Date.now(),s=c(t);if(a=e,l=t,s){if(null===d)return u=t,d=setTimeout(g,i),r?h(t):n;else if(void 0!==o)return p(),h(t)}return null===d&&p(),n}return m.flush=function(){if(null!==d&&a){let e=Date.now();return clearTimeout(d),d=null,h(e)}return n},m.cancel=function(){null!==d&&clearTimeout(d),u=0,a=void 0,l=void 0,d=null},m}},745293(e,i,t){t.d(i,{A:()=>a});let a="M17.496 14.572a1 1 0 0 1-1 1h-.001a1.001 1.001 0 0 1-.999-1.001l.002-4.652-7.29 7.288a.995.995 0 0 1-.707.293.999.999 0 0 1-.707-1.707l7.293-7.29L9.428 8.5a1 1 0 0 1 .001-2h.001l8.071.005-.005 8.067zM12 0C5.373 0 0 5.373 0 12c0 6.628 5.373 12 12 12 6.628 0 12-5.372 12-12 0-6.627-5.372-12-12-12z"},766284(e,i,t){t.d(i,{A:()=>a});let a="M12 18.5A6.508 6.508 0 0 1 5.5 12c0-1.706.689-3.307 1.835-4.5H6.5a1 1 0 1 1 0-2h4.185v4.474a1 1 0 0 1-2 0V8.972A4.505 4.505 0 0 0 7.5 12c0 2.481 2.019 4.5 4.5 4.5s4.5-2.019 4.5-4.5a4.49 4.49 0 0 0-3.112-4.283 1 1 0 1 1 .615-1.902A6.482 6.482 0 0 1 18.5 12c0 3.584-2.916 6.5-6.5 6.5M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0"},94047(e,i,t){t.d(i,{A:()=>o});var a=t(97407),n=t(296540),l=t(328138),r=t(196303),s=t(474848);function o({onVisibilityChanged:e,children:i,...t}){(0,n.useEffect)(()=>{(0,a.A)("VisibilityChangedWrapper","/app/packages/useVisibilityChanged/VisibilityChangedWrapper.tsx")},[]);let o=(0,r.A)({onVisibilityChanged:e,...t});return(0,s.jsx)(l.az,{ref:o,children:i})}},866127(e,i,t){t.d(i,{A:()=>a});function a(e,i){let{organicVideosAutoplaying:t,promotedVideosAutoplaying:a,videoCarouselModuleAutoplaying:n}=i,l={...t,...a,...n};return l[e]&&l[e].currentTime}},603212(e,i,t){t.d(i,{A:()=>a});let a={debugPinImpressions:999,max:9999,pinActionWrapper:101,saved:102,storyPinImage:-1}},965485(e,i,t){t.d(i,{V:()=>n,g:()=>a});let a=e=>!!e&&/^\/pin\/[\w-]+\/?$/.test(e.pathname),n=e=>{let i=[...e].reverse().find(({location:e})=>e&&!a(e));return i&&i.location&&(({pathname:e})=>/^\/search\/pins\//.test(e))(i.location)?(({pathname:e,search:i})=>{let t=/^\/search\/pins\/(\?.*)$/.exec(e),a=(i||t&&t[1]||"").substr(1).split("&").map(e=>e.split("=")).find(e=>"q"===e[0]);return a?decodeURIComponent(a[1]):""})(i.location):""}},956363(e,i,t){t.d(i,{A:()=>_});var a,n=t(97407),l=t(296540);t(918312);var r=t(328138),s=t(228159),o=t(698781),d=t(998345),u=t(643357),h=t(939043),c=t(622165),g=t(534955),p=t(983686),m=t(727914),y=t(474848);function v(e,i,t){var a;return(i="symbol"==typeof(a=function(e,i){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,i||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(e)}(i,"string"))?a:a+"")in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}let f=(void 0!==a||(a=t(131510)).hash&&"4be444081491499e2b6e9d6768314918"!==a.hash&&console.error("The definition of 'DeprecatedCarousel_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),a);class x extends l.Component{constructor(...e){super(...e),v(this,"state",{showBadge:!0,startImpressionTimer:!1}),v(this,"renderBadge",()=>{let{carouselData:e,isCloseup:i,showCarouselBadge:t}=this.props;if(!e)return null;let{showBadge:a}=this.state,{carouselSlots:n,index:l}=e;return!i&&t?(0,y.jsx)(r.az,{alignItems:"center",color:"selected",dangerouslySetInlineStyle:{__style:{opacity:.8*!!a,transition:"opacity .3s"}},"data-test-id":"carousel-badge",display:"flex",height:35,justifyContent:"center",marginEnd:5,marginTop:5,position:"absolute",right:!0,rounding:200,width:35,zIndex:new r.rk(1),children:(0,y.jsx)(r.KJ,{color:"inverse",children:`${(l??0)+1}/${(n??[]).length}`})}):null}),v(this,"onLoadImage",()=>{this.setState({startImpressionTimer:!0}),this.props.onLoad?.()}),v(this,"onImageLoadError",()=>{this.setState({startImpressionTimer:!1}),this.props.onError?.()})}componentDidMount(){(0,n.A)("DeprecatedCarousel","/app/www/common/Carousel/DeprecatedCarousel.tsx"),this.hideBadgeTimeout=setTimeout(()=>this.setState({showBadge:!1}),3e3)}componentDidUpdate(e){let{showBadge:i}=this.state,{carouselData:t}=e,{carouselData:a}=this.props;if(!t||!a)return;let{index:n}=t,{index:l}=a;i&&(this.hideBadgeTimeout&&clearTimeout(this.hideBadgeTimeout),this.hideBadgeTimeout=setTimeout(()=>this.setState({showBadge:!1}),3e3)),n!==l&&(this.hideBadgeTimeout&&clearTimeout(this.hideBadgeTimeout),this.setState({showBadge:!0}))}componentWillUnmount(){this.hideBadgeTimeout&&clearTimeout(this.hideBadgeTimeout)}render(){let e,i,t,{isCloseup:a,carouselIndex:n,closeupHeight:l,closeupWidth:s=0,widthRatio:o=1,cropHeight:u,cropWidth:c,carouselData:g,disableTransition:v,highResOnly:f,pinId:x,imageSignature:_,isEditMode:b,isDenseView:k,isThirdPartyAd:w,_fixCompletedOnLoad:P}=this.props;if(!g)return null;if(o>1||o<0)throw Error("widthRatio should be between 0 and 1 inclusive");let{carouselSlots:T}=g,V=g.index??0,S=void 0!==n?n:V??0,{imageSizeMap:L}=T[S]||{},C=Math.floor((e=a?s:!a&&c||(f?474:k?d.WH:d.rt))*o),I=L?.["236x"]||{},F=u||I.height||0,A=c||I.width||236,D=l||F/A*C,E=(t=Object.keys(i=T.reduce((e,i)=>{let{imageSizeMap:t}=i,{height:a,width:n}=t?.["736x"]||t?.["236x"]||{},l=`${n??1}x${a??1}`,r=e[l]?.times||0;return{...e,[l]:{imageHeight:a,imageWidth:n,times:r+1}}},{})).reduce((e,t)=>i[t].times>e.times?i[t]:e,{times:-1,imageHeight:-1,imageWidth:-1}),Object.keys(i).length>1?{imageHeight:t.imageHeight,imageWidth:t.imageWidth}:null);return(0,y.jsxs)(r.az,{alignItems:"center","data-test-id":"carousel-pin","data-test-image-signature":_,display:"flex",height:D,minHeight:h.sj,overflow:"hidden",children:[!b&&this.renderBadge(),(0,y.jsx)(m.oc,{carouselData:{...g,type:"canonical"},impressionType:"Pin",isPaused:!this.state.startImpressionTimer,loggingId:x,slotIndex:V??0,viewParameter:72,viewType:1,children:({impressionTrackerRef:e})=>(0,y.jsx)(r.az,{ref:e,"data-test-id":`carousel-impression-ref-${x}-${V}`,height:D,overflow:"hidden",position:"absolute",width:C})},`carousel-impression-key-${S}`),(0,y.jsx)(r.az,{dangerouslySetInlineStyle:{__style:{transition:v?"":"left .3s",left:(0,p.WD)(T.length,C,e,S)}},direction:"row",display:"flex",height:"100%",left:!0,position:"relative",width:C*T.length,children:T.map((i,t)=>{if(a){let a=t===T.length-1;return(({pinId:e,slot:i,slotIndex:t,onError:a,onLoad:n,widthToUse:l,gap:s},o)=>{let{url:d,width:u,height:h}=["564x","736x","474x","236x"].map(e=>i.imageSizeMap?.[e]).find(e=>e?.url)||{},{details:c=""}=i,g=(0,p.JF)(c,o,t);return(0,y.jsx)(r.az,{"data-test-id":"carousel-slot-container",height:"100%",marginEnd:s,width:l,children:(0,y.jsx)(r.n1,{height:"100%",wash:!0,children:d&&(0,y.jsx)(r._V,{alt:g,fit:"contain",naturalHeight:h??1,naturalWidth:u??1,onError:a,onLoad:n,src:d})})},`carousel-slot-${e}-${t}`)})({pinId:x,slot:i,slotIndex:t,onError:this.onImageLoadError,onLoad:this.onLoadImage,widthToUse:C,gap:+(C<e&&!a)},this.props.i18n)}return((e,i,t,a,n,l,s,o,d,u,h,c,g,m,v,f)=>{let x,{imageSizeMap:_,details:b=""}=t,k=236,w=236,P="";l?(k=474,w=_&&Math.min(k/.8,k/((_["564x"]?.width??1)/(_["564x"]?.height??1))),P=_&&_["564x"]?.url):_&&_["736x"]?(w=_&&_["736x"]&&_["736x"].height,k=_&&_["736x"]&&_["736x"].width,P=_&&_["736x"]&&_["736x"].url):_&&_["236x"]&&(w=_&&_["236x"]&&_["236x"].height,k=_&&_["236x"]&&_["236x"].width,P=_&&_["236x"]&&_["236x"].url),g&&m&&(w=Math.min(g*m,w??1)),x=l?`${_?.["564x"]?.url??""} 1x`:[_?.["474x"]&&`${_["474x"].url??""} 2x`,_?.["736x"]&&`${_["736x"].url??""} 3x`,_?.orig&&`${_.orig.url??""} 4x`].filter(Boolean).join(", ");let T=(0,p.JF)(b,i,n),V=c?void 0:w,S=c?void 0:k,{boxHeight:L,boxWidth:C}=v?{boxHeight:v?.imageHeight,boxWidth:v?.imageWidth}:{boxHeight:V,boxWidth:S};return(0,y.jsx)(r.az,{"data-test-id":"carousel-slot-container",height:L??void 0,width:C??void 0,children:(0,y.jsx)(r.az,{"data-test-id":`carousel-img-${n}`,height:c?h:void 0,width:c||void 0,children:P&&(0,y.jsx)(r._V,{_fixCompletedOnLoad:e,alt:T,crossOrigin:f?"anonymous":void 0,fit:c?"cover":"none",naturalHeight:w??1,naturalWidth:k??1,onError:s,onLoad:o,src:P,srcSet:x})})},`carousel-slot-${a}-${n}`)})(P,this.props.i18n,i,x,t,f,this.onImageLoadError,this.onLoadImage,0,0,u,c,D,C,E,w)})})]})}}function _({pinKey:e,...i}){var t;let a;(0,l.useEffect)(()=>{(0,n.A)("DeprecatedCarousel","/app/www/common/Carousel/DeprecatedCarousel.tsx")},[]);let r=(0,u.A)(),{checkExperiment:d}=(0,c.A)(),{isAuthenticated:h}=(0,g._8)(),p=(0,o.A)(f,e),m=(0,s.A)(p),v=m&&{...m,carouselSlots:(t=m.carouselSlots,a=["236x","474x","564x","736x"].map(e=>{let i=Math.min(...t.map(i=>i.imageSizeMap?.[e]?.height||1/0)),a=Math.min(...t.map(i=>i.imageSizeMap?.[e]?.width||1/0));return{imageKey:e,height:i,width:a}}),t.map(e=>a.reduce((e,{imageKey:i,height:t,width:a})=>({...e,imageSizeMap:{...e.imageSizeMap,...e.imageSizeMap?.[i]?{[i]:{...e.imageSizeMap[i],height:t,width:a}}:{}}}),e)))};return(0,y.jsx)(x,{...i,carouselData:v,checkExperiment:d,i18n:r,imageSignature:p.imageSignature,isAuthenticated:h,pinId:p.entityId})}v(x,"defaultProps",{showCarouselBadge:!0})},916403(e,i,t){t.d(i,{Ay:()=>S});var a,n=t(97407),l=t(296540);t(918312);var r=t(328138),s=t(632321),o=t(984273),d=t(698781),u=t(49887),h=t(534955),c=t(356932),g=t(990213),p=t(687145),m=t(947814),y=t(474848);function v(e,i,t){var a;return(i="symbol"==typeof(a=function(e,i){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,i||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===i?String:Number)(e)}(i,"string"))?a:a+"")in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}let f=(0,m.A)(()=>Promise.all([t.e("91796"),t.e("69130"),t.e("57120")]).then(t.bind(t,670723)),void 0,e=>670723,"app-www-video-VideoWrapper",e=>["91796","69130","57120"]),x=[0,.25,.5,.75,.95,.97],_=[0,.5,.8,.99,1],b={rootMargin:"-64px 0px 0px 0px",threshold:[...p.o8]},k=Object.freeze({LOADING:0,PLAYING:1,PAUSED:2,STALLING:3}),w=(void 0!==a||(a=t(879436)).hash&&"93ed23334d5bac81ac8410f05c4f2031"!==a.hash&&console.error("The definition of 'VideoWithContextLogging_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),a);function P(){return new Date().getTime()}function T(e){return!!e.volume&&e.volume>0}class V extends l.Component{constructor(e){super(e),v(this,"videoWrapperRef",(0,l.createRef)()),v(this,"loggedQuartiles",new Set),v(this,"handleWindowResize",()=>{if(!this.fullscreen){let e=this.getDimensions(),{height:i,width:t}=this.currentInterval;e.height!==i||e.width!==t?this.startNewInterval(e):(this.currentInterval.windowHeight=e.windowHeight,this.currentInterval.windowWidth=e.windowWidth)}}),v(this,"handlePlayheadDown",({event:e})=>{let{onPlayheadDown:i}=this.props;this.setState({seeking:!0}),i&&i({event:e})}),v(this,"handlePlayheadUp",({event:e})=>{let{onPlayheadUp:i}=this.props;this.setState({seeking:!1}),i&&i({event:e})}),v(this,"handleLoop",()=>{this.videoTime=0}),v(this,"handlePlaying",e=>{this.logVideoStart(),this.props.onPlaying&&this.props.onPlaying(e)}),v(this,"handleTimeChange",e=>{let{seeking:i,ready:t}=this.state;if(!this.currentInterval.videoDuration)return;let a=1e3*e.time,n=function(e,i,t,a){if(e>i||t<=0)return null;for(let n of a){let a=n*t;if(e<=a&&i>a)return n}return null}(this.videoTime,a,this.currentInterval.videoDuration,x);if("number"==typeof n&&this.props.playing&&!i&&t){let e=P();this.loggedQuartiles.has(n)||(this.logVideoEvent(6906,{...this.currentInterval,startTime:e,endTime:e,videoStartTime:0,videoEndTime:0,quartile:Math.floor(4*n),quartilePercentValue:n}),this.loggedQuartiles.add(n))}this.videoTime=a,this.props.onTimeChange&&this.props.onTimeChange(e)}),v(this,"handleDurationChange",e=>{this.currentInterval.videoDuration=1e3*e.duration,this.props.onDurationChange&&this.props.onDurationChange(e)}),v(this,"handleReady",e=>{let{ready:i}=this.state;i||this.setState({ready:!0}),this.props.onReady&&this.props.onReady(e)}),v(this,"handleEnded",e=>{this.logFourthQuartileEvent(),this.props.loop&&(this.startNewInterval(),this.currentInterval.videoStartTime=0),this.props.onEnded&&this.props.onEnded(e)}),v(this,"handleVisibilityChange",e=>{if(0===e.length)return;let i=function(e){for(let i=0;i<_.length;i+=1){let t=_[i],a=_[i+1];if(null==a||t<=e&&e<a)return t}return null}(Number.parseFloat(e.slice(-1)[0].intersectionRatio.toFixed(2)));"number"==typeof i&&(this.visible=i>=.5),null==i||i===this.currentInterval.viewability||this.fullscreen||(0===i?this.startNewInterval({viewability:i,playbackState:k.PAUSED}):this.startNewInterval({viewability:i}))}),v(this,"handleFullscreenChange",({event:e,fullscreen:i})=>{if(i){let{height:e,width:i}=window.screen;this.startNewInterval({height:e,width:i,windowHeight:e,windowWidth:i})}else i||this.startNewInterval(this.getDimensions());this.fullscreen=i,this.props.onFullscreenChange&&this.props.onFullscreenChange({event:e,fullscreen:i})}),v(this,"handleClose",()=>{this.startNewInterval()}),this.state={ready:!1,seeking:!1,started:!1};let i=P();this.handleWindowResize=(0,o.A)(this.handleWindowResize,1e3),this.currentInterval={videoDuration:0,startTime:i,endTime:i,videoStartTime:0,videoEndTime:0,isAudible:T(e),playbackState:this.getPlaybackState(e,this.state),quartile:-1,quartilePercentValue:0,height:null,width:null,windowHeight:null,windowWidth:null,viewability:null},this.videoTime=0,this.fullscreen=!1,this.visible=null}componentDidMount(){(0,n.A)("VideoWithContextLogging","/app/www/video/VideoWithContextLogging.tsx"),this.currentInterval={...this.currentInterval,...this.getDimensions()},window.addEventListener("resize",this.handleWindowResize),window.addEventListener("beforeunload",this.handleClose)}componentDidUpdate(e,i){let t={};T(e)&&!T(this.props)?t.isAudible=!1:!T(e)&&T(this.props)&&(t.isAudible=!0);let a=this.getPlaybackState(this.props,this.state);this.getPlaybackState(e,i)!==a&&(t.playbackState=a),Object.keys(t).length>0&&this.startNewInterval(t)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("beforeunload",this.handleClose),this.startNewInterval()}getPlaybackState(e,i){return i.ready?e.playing&&!i.seeking?k.PLAYING:k.PAUSED:k.LOADING}getDimensions(){let e,i;if(this.videoWrapperRef.current){let t=this.videoWrapperRef.current;t.clientHeight&&t.clientWidth&&(e=t.clientHeight,i=t.clientWidth)}return{height:e,width:i,windowHeight:window.innerHeight,windowWidth:window.innerWidth}}logVideoEvent(e,i){let{closeupStoryPinViewability:t,contextLogData:a,logContextEvent:n,playing:l,surface:r}=this.props,{seeking:s}=this.state,{height:o,width:d,windowHeight:u,windowWidth:h,viewability:c,...g}=i,{playbackState:p}=g;if((p!==k.LOADING||6904!==e)&&(p!==k.PAUSED&&p!==k.STALLING||6904!==e)&&null!=o&&null!=d&&null!=u&&null!=h&&null!=c){let i={...g,gridAutoplay:6904===e&&l&&!s&&("AuthHomefeed"===r||"SearchItem"===r||"RelatedPinGrid"===r||"PdpRelatedPinGrid"===r),height:o,width:d,windowHeight:u,windowWidth:h,viewability:t||c};n({event_type:e,...function(e){let{eventData:{videoEvent:{gridAutoplay:i,videoDuration:t,startTime:a,endTime:n,videoStartTime:l,videoEndTime:r,isAudible:s,height:o,width:d,playbackState:u,quartile:h,quartilePercentValue:c,windowHeight:g,windowWidth:p,viewability:m}},component:y,objectId:v,view:f,viewParameter:x,..._}=e;return{component:y,object_id_str:v,view_type:f,view_parameter:x,aux_data:{..._},event_data:{videoEventData:{gridAutoplay:i,videoDuration:t?Math.floor(t):0,time:a,endTime:n,videoTime:l?Math.floor(l):0,endVideoTime:r?Math.floor(r):0,isAudible:s,height:o,width:d,playbackState:u,quartile:h,quartilePercentValue:c,windowHeight:g,windowWidth:p,viewability:m}}}}({...a,view:this.fullscreen?108:a.view,eventData:{videoEvent:i}})})}}logFourthQuartileEvent(){if(!this.loggedQuartiles.has(1)){let e=P();this.logVideoEvent(6906,{...this.currentInterval,startTime:e,endTime:e,videoStartTime:0,videoEndTime:0,quartile:4,quartilePercentValue:1}),this.loggedQuartiles.add(1)}}logVideoStart(){if(this.state.started)return;let{contextLogData:e,setVideoPlayed:i}=this.props;i(e.objectId),this.setState({started:!0})}startNewInterval(e){let i=P();this.logVideoEvent(6904,{...this.currentInterval,endTime:i,videoEndTime:this.videoTime}),this.currentInterval={...this.currentInterval,...e,startTime:i,videoStartTime:this.videoTime,endTime:-1,videoEndTime:-1}}render(){let{rootMargin:e,surface:i,aspectRatio:t,backgroundColor:a,captions:n,contextLogData:l,controls:s,fallback:o,hlsConfig:d,isAutoPlay:h,loop:g,objectFit:p,onLoadedChange:m,onControlsPause:v,onControlsPlay:x,onSeek:_,onVolumeChange:k,pin:w,playbackRate:P,playing:T,playsInline:V,poster:S,preload:L,seekTime:C,src:I,videoStartTime:F,volume:A,variant:D,setVideoRef:E,isMainCloseupIdeaVideo:K}=this.props,{seeking:j}=this.state;return void 0!==e&&(b.rootMargin=i?(0,c.W)(i):e),(0,y.jsx)(u.A,{onVisibilityChange:this.handleVisibilityChange,options:b,children:e=>(0,y.jsx)(r.az,{ref:i=>{e.current=i,this.videoWrapperRef.current=i},height:"inherit",children:(0,y.jsx)(f,{aspectRatio:t,backgroundColor:a,captions:n,contextLogData:l,controls:s,fallback:o,hlsConfig:d,isAutoPlay:h,isMainCloseupIdeaVideo:K,loop:g,objectFit:p,onControlsPause:v,onControlsPlay:x,onDurationChange:this.handleDurationChange,onEnded:this.handleEnded,onFullscreenChange:this.handleFullscreenChange,onLoadedChange:m,onLoop:this.handleLoop,onPlay:()=>{},onPlayError:()=>{},onPlayheadDown:this.handlePlayheadDown,onPlayheadUp:this.handlePlayheadUp,onPlaying:this.handlePlaying,onReady:this.handleReady,onSeek:_,onTimeChange:this.handleTimeChange,onVolumeChange:k,pinKey:w,playbackRate:P,playing:!j&&T,playsInline:V,poster:S,preload:L,seekTime:C,setVideoRef:E,src:I,variant:D,videoStartTime:F,visible:this.visible,volume:A})})})}}function S(e){(0,l.useEffect)(()=>{(0,n.A)("VideoWithContextLogging","/app/www/video/VideoWithContextLogging.tsx")},[]);let{pinKey:i}=e,t=(0,d.A)(w,i),{logContextEvent:a}=(0,s.o)(),{setVideoPlayed:r}=(0,g.y)(),o=(0,h._8)();return(0,y.jsx)(V,{...e,logContextEvent:a,pin:t,requestContext:o,setVideoPlayed:r})}v(V,"defaultProps",r.Ce.defaultProps)},687145(e,i,t){t.d(i,{$r:()=>l,Um:()=>a,_d:()=>s,f$:()=>r,o8:()=>n});let a=2,n=[0,.01,.02,.03,.04,.05,.06,.07,.08,.09,.1,.11,.12,.13,.14,.15,.16,.17,.18,.19,.2,.21,.22,.23,.24,.25,.26,.27,.28,.29,.3,.31,.32,.33,.34,.35,.36,.37,.38,.39,.4,.41,.42,.43,.44,.45,.46,.47,.48,.49,.5,.51,.52,.53,.54,.55,.56,.57,.58,.59,.6,.61,.62,.63,.64,.65,.66,.67,.68,.69,.7,.71,.72,.73,.74,.75,.76,.77,.78,.79,.8,.81,.82,.83,.84,.85,.86,.87,.88,.89,.9,.91,.92,.93,.94,.95,.96,.97,.98,.99,1],l={backgroundImage:"linear-gradient(to top, rgba(0, 0, 0, .4), rgba(0, 0, 0, 0))",pointerEvents:"none",bottom:0},r=128,s=e=>e&&document.querySelector(`video[poster="${e}"]`)||null}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/4786.en_GB-7422c6a7963199bb.mjs.map